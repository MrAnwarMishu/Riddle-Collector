<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Riddle Collector</title>

<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Roboto,Arial}
  body{
    background:linear-gradient(135deg,#667eea,#764ba2);
    min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px
  }
  .container{
    width:100%;max-width:800px;background:#fff;border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,.2);display:flex;flex-direction:column;max-height:90vh
  }
  .header{background:linear-gradient(135deg,#2c3e50,#4a6491);color:#fff;padding:24px;text-align:center}
  .stats,.controls,.footer{
    background:#f8f9fa;border-color:#e9ecef
  }
  .stats,.controls{
    display:flex;justify-content:center;flex-wrap:wrap;gap:12px;padding:12px
  }
  .stat-item{
    text-align:center;background:#fff;border-radius:8px;
    padding:8px 16px;box-shadow:0 2px 4px rgba(0,0,0,.1);min-width:100px
  }
  .stat-value{font-size:22px;font-weight:700;color:#2c3e50}
  .stat-label{font-size:12px;color:#6c757d;text-transform:uppercase}
  .button{
    padding:12px 20px;border:0;border-radius:8px;font-weight:600;
    cursor:pointer;display:flex;align-items:center;gap:8px;min-width:120px;justify-content:center;
    transition:.2s
  }
  .button-primary{background:#4caf50;color:#fff}
  .button-danger{background:#ff4757;color:#fff}
  .button-success{background:#2196f3;color:#fff}
  .button:hover{transform:translateY(-2px)}
  .content{
    flex:1;display:flex;flex-direction:column;overflow:hidden;
    position:relative; /* scroll button overlay */
  }
  .list-container{
    flex:1;overflow-y:auto;padding:10px 0;
  }
  #riddlesList li{
    padding:16px 20px;border-bottom:1px solid #e9ecef;font-size:15px;line-height:1.5
  }
  #riddlesList li:nth-child(even){background:#fafafa}
  #riddlesList li:hover{background:#f8f9fa}
  .empty-state{
    height:100%;display:flex;align-items:center;justify-content:center;
    color:#6c757d;text-align:center;padding:20px
  }
  .notification{
    position:fixed;top:20px;right:20px;background:#4caf50;color:#fff;
    padding:14px 20px;border-radius:8px;display:none;z-index:999
  }
  .error{background:#ff4757}
  .footer{
    padding:12px;text-align:center;font-size:13px;color:#6c757d;border-top:1px solid #e9ecef
  }
  .status-indicator{
    width:12px;height:12px;border-radius:50%;background:#dc3545
  }
  .active{background:#4caf50;animation:pulse 1.8s infinite}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
  @media(max-width:768px){
    .button{width:100%}
  }

  /* Scroll to Top button inside content */
  #scrollTopBtn {
    position:absolute; /* content-‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá overlay */
    bottom:10px;
    right:10px;
    width:40px;
    height:40px;
    border:none;
    border-radius:50%;
    background:#2196f3;
    color:#fff;
    font-size:20px;
    cursor:pointer;
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:10;
    display:none; /* scroll ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá */
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
  }
</style>
</head>

<body>
<div class="container">
  <div class="header"><h1>üìö Riddle Collector</h1></div>

  <div class="stats">
    <div class="stat-item"><div id="totalCount" class="stat-value">0</div><div class="stat-label">Total</div></div>
    <div class="stat-item"><div id="speedValue" class="stat-value">1/s</div><div class="stat-label">Speed</div></div>
    <div class="stat-item"><div id="uniqueCount" class="stat-value">0</div><div class="stat-label">Unique</div></div>
  </div>

  <div class="controls">
    <button id="toggleBtn" class="button button-primary">
      <span class="status-indicator"></span><span>Start Collection</span>
    </button>
    <button id="clearBtn" class="button button-danger">üóëÔ∏è Clear</button>
    <button id="copyBtn" class="button button-success">üìã Copy</button>
  </div>

  <div class="content">
    <div class="list-container">
      <ul id="riddlesList"></ul>
      <div id="emptyState" class="empty-state">No riddles yet. Click Start!</div>
    </div>

    <!-- Scroll to Top Button inside content -->
    <button id="scrollTopBtn">‚Üë</button>
  </div>

  <div class="footer">‚ö° Collecting unique riddles in real-time</div>
</div>

<!-- Notification -->
<div id="notification" class="notification"><span id="notificationText">Copied!</span></div>

<script>
const api="https://riddles-api.vercel.app/random";
const $=id=>document.getElementById(id);
const list=$("riddlesList"), empty=$("emptyState");
const listContainer = document.querySelector('.list-container');
const scrollTopBtn = document.getElementById('scrollTopBtn');
const notify=$("notification"), txt=$("notificationText");
const totalEl=$("totalCount"), uniqEl=$("uniqueCount"), speedEl=$("speedValue");

let timer=null, speed=1, all=new Set(), total=0, autoScroll=true;

function stats(){ totalEl.textContent=total; uniqEl.textContent=all.size; speedEl.textContent=`${speed}/s`; }
function toast(m,err=false){ txt.textContent=m; notify.className=err?"notification error":"notification"; notify.style.display="block"; setTimeout(()=>notify.style.display="none",2000) }
function toggleEmpty(){ empty.style.display=all.size?"none":"flex" }

function scrollToBottom() {
  if (!autoScroll) return;
  const target = listContainer.scrollHeight;
  const start = listContainer.scrollTop;
  const distance = target - start;
  const duration = 300;
  const startTime = performance.now();

  function animate(time) {
    const elapsed = time - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const ease = 0.5 - Math.cos(progress * Math.PI) / 2;
    listContainer.scrollTop = start + distance * ease;
    if (progress < 1) requestAnimationFrame(animate);
  }

  requestAnimationFrame(animate);
}

async function fetchRiddle(){
  try{
    total++;
    const {riddle,answer}=await fetch(api).then(r=>r.json());
    if(!riddle||!answer) throw 0;
    const key=riddle+"|"+answer;

    if(!all.has(key)){
      all.add(key);
      list.insertAdjacentHTML("beforeend",
        `<li><div style="display:flex;gap:20px">
           <div style="width:60%;font-weight:600">${riddle}</div>
           <div style="width:40%">${answer}</div>
         </div></li>`
      );
      scrollToBottom();
    }
    stats(); toggleEmpty();
  }catch{ toast("Failed!",true) }
}

$("toggleBtn").onclick=()=>{
  if(timer){
    clearInterval(timer); timer=null;
    toggleBtn.innerHTML=`<span class="status-indicator"></span><span>Start Collection</span>`;
    toggleBtn.className="button button-primary";
  } else {
    fetchRiddle();
    timer=setInterval(fetchRiddle,1000/speed);
    toggleBtn.innerHTML=`<span class="status-indicator active"></span><span>Stop Collection</span>`;
    toggleBtn.className="button button-danger";
  }
};

$("clearBtn").onclick=()=>{
  list.innerHTML=""; all.clear(); total=0;
  stats(); toggleEmpty();
};

$("copyBtn").onclick=()=>{
  const text=[...list.children]
    .map(li=>[...li.querySelectorAll("div>div")].map(t=>t.innerText).join("\t"))
    .join("\n");

  if(!text) return toast("Nothing to copy!",true);

  navigator.clipboard.writeText(text);
  const old=copyBtn.textContent;
  copyBtn.textContent="‚úì Copied"; copyBtn.disabled=true;
  setTimeout(()=>{copyBtn.textContent=old;copyBtn.disabled=false},1000);
};

// Scroll to Top button: visibility & click
scrollTopBtn.style.display = "none";

listContainer.addEventListener("scroll", ()=>{
  if(listContainer.scrollTop > 50){
    scrollTopBtn.style.display = "flex";
  } else {
    scrollTopBtn.style.display = "none";
  }
});

scrollTopBtn.addEventListener("click", ()=>{
  const start = listContainer.scrollTop;
  const distance = -start;
  const duration = 300;
  const startTime = performance.now();

  function animate(time) {
    const elapsed = time - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const ease = 0.5 - Math.cos(progress * Math.PI) / 2;
    listContainer.scrollTop = start + distance * ease;
    if (progress < 1) requestAnimationFrame(animate);
  }

  requestAnimationFrame(animate);
});

toggleEmpty();
</script>
</body>
</html>
